-- ============================
-- TABELA: exercicio
-- ============================
CREATE TABLE exercicio (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome VARCHAR(255) NOT NULL UNIQUE,
    musculo_principal VARCHAR(255) NOT NULL,
    descricao TEXT
);

-- ============================
-- TABELA: ficha_treino
-- ============================
CREATE TABLE ficha_treino (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    aluno_id BIGINT NOT NULL,
    instrutor_id BIGINT NOT NULL,
    data_criacao DATE DEFAULT CURRENT_DATE,
    data_vencimento DATE,
    is_ativa BOOLEAN DEFAULT TRUE,

    CONSTRAINT fk_ficha_treino_aluno FOREIGN KEY (aluno_id) REFERENCES usuario(id),
    CONSTRAINT fk_ficha_treino_instrutor FOREIGN KEY (instrutor_id) REFERENCES usuario(id)
);

-- ============================
-- TABELA: ficha_avaliacao
-- ============================
CREATE TABLE ficha_avaliacao (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    aluno_id BIGINT NOT NULL,
    instrutor_id BIGINT NOT NULL,
    data_avaliacao DATE DEFAULT CURRENT_DATE,
    peso_kg DOUBLE PRECISION NOT NULL,
    altura_cm DOUBLE PRECISION NOT NULL,
    imc DOUBLE PRECISION,
    circunferencia_cintura_cm DOUBLE PRECISION,
    circunferencia_abdomen_cm DOUBLE PRECISION,
    circunferencia_quadril_cm DOUBLE PRECISION,
    historico_saude TEXT,
    observacoes_gerais TEXT,

    CONSTRAINT fk_ficha_avaliacao_aluno FOREIGN KEY (aluno_id) REFERENCES usuario(id),
    CONSTRAINT fk_ficha_avaliacao_instrutor FOREIGN KEY (instrutor_id) REFERENCES usuario(id)
);

-- ============================
-- TABELA: item_treino
-- ============================
CREATE TABLE item_treino (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ficha_treino_id BIGINT NOT NULL,
    exercicio_base_id BIGINT NOT NULL,
    series INT NOT NULL,
    repeticoes INT NOT NULL,
    carga_estimada_kg DOUBLE PRECISION,
    observacoes TEXT,

    CONSTRAINT fk_item_treino_ficha_treino FOREIGN KEY (ficha_treino_id) REFERENCES ficha_treino(id),
    CONSTRAINT fk_item_treino_exercicio_base FOREIGN KEY (exercicio_base_id) REFERENCES exercicio(id)
);